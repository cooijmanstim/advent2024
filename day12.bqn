x â† >â€¢FLinesâŠ‘â€¢args

dirs â† â¥Š âŠ¢â€¿âŒ½ {ğ• ğ• 0â€¿1}âŒœ -â€¿âŠ¢
Segment â† {ğ•Šx:
  segmentation â† 0Â¨x
  InBounds â† âˆ§Â´ 0âŠ¸â‰¤âˆ§<âŸœ(â‰¢x)
  Flood â† {sğ•Ši:
    0=iâŠ‘segmentation?
    segmentation sâŒ¾(iâŠ¸âŠ‘)â†©
    sâŠ¸FloodÂ¨ {ğ•Šj: i =â—‹(âŠ‘âŸœx) j}Â¨âŠ¸/ InBoundsÂ¨âŠ¸/ iâŠ¸+Â¨ dirs
    ;@ # already visited
  }
  (1+â†•â‰ â¥Šx) FloodÂ¨ (â¥Šâ†•â‰¢x)
  âŠâŒ¾â¥Š segmentation # canonicalize numbering
}

segmentation â† Segment x

Crop â† âˆ¨Â´Ë˜âŠ¸/ {ğ”½ _ğ•£ ğ•©: ğ”½âŒ¾â‰ ğ”½ ğ•©}
Pad â† 1âŠ¸âŒ½âˆ˜(0â€¿0âŠ¸âˆ¾)Ë˜ {ğ”½ _ğ•£ ğ•©: ğ”½âŒ¾â‰ ğ”½ ğ•©}
regions â† Padâˆ˜Cropâˆ˜(segmentationâŠ¸=)Â¨ â†•1+âŒˆÂ´â¥Šsegmentation  # one-hot map for each region
edgemapss â† {ğ•Šr: {(Â«Ë˜âŠ¸-)âŒ¾ğ• r}Â¨ âŠ¢â€¿â‰}Â¨ regions  # h/v edgemap for each region

areas â† +Â´âˆ˜â¥ŠÂ¨ regions
edges1 â† +Â´Â¨ +Â´âˆ˜â¥ŠÂ¨Â¨| edgemapss  # count edges
â€¢Show areas +Â´âˆ˜Ã— edges1

edges2 â† +Â´Â¨ {â‰ â· (ğ•©â‰ 0)âŠ¸(/â—‹â¥Š) Segment ğ•©}Â¨Â¨ edgemapss  # count regions of edges
â€¢Show areas +Â´âˆ˜Ã— edges2

