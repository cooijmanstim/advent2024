MainDiagonalâ†{(â¥Šğ•©)âŠËœ(1+Â¯1âŠ‘â‰¢ğ•©)Ã—â†•âŒŠÂ´â‰¢ğ•©}
Diagonalsâ†{ğ•Šx:
  mâ€¿nâ†â‰¢x
  âˆ¾Â´ âŸ¨
    (â‹ˆMainDiagonal x),
    ({ğ•Ši: MainDiagonal iâŠ¸â†“ x}Â¨ 1â†“â†•m),
    ({ğ•Šj: MainDiagonal jâŠ¸â†“Ë˜x}Â¨ 1â†“â†•n),
  âŸ©
}

x â† > â€¢FLines âŠ‘â€¢args
haystacks â† âˆ¾Â´ âŸ¨ <Ë˜x, <Ë˜â‰x, Diagonals x, Diagonals âŒ½x âŸ©
needles â† "XMAS"â€¿"SAMX"
â€¢Show +Â´â¥Š (+Â´âˆ˜â¥Š)Â¨ needles â·âŒœ haystacks

â€¢Show +Â´â¥Š {âˆ§Â´ âˆ¨Â´<Ë˜ "MAS"â€¿"SAM" â‰¡âŒœ<Ë˜ (2â€¿4â€¿6â‰0â€¿4â€¿8) âŠ â¥Šğ•©}â‰2 3â€¿3â†•x

