ParseNat â† 10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½ -âŸœ'0'
IsDigit â† '0'âŠ¸â‰¤âˆ§â‰¤âŸœ'9'
IdentifyRegions â† Â¯1âŠ¸+ âŠ¢ Ã— +`âˆ˜(0âŠ¸âŒˆ)âˆ˜(-âŸœÂ»)
_CollectRuns â† {IdentifyRegionsâˆ˜ğ”½âŠ¸âŠ”}
CollectNumbers â† {ğ•Šs: ParseNatÂ¨ IsDigit _CollectRuns s}

l â† CollectNumbersÂ¨ â€¢FLinesâŠ‘â€¢args
reg â† âŠ‘Â¨ 3â†‘l
prog â† Â¯1âŠ‘l

â€¢Show reg
â€¢Show prog
!âˆ§Â´prog<8

offâ†2â‹†52 â‹„ Xor â† {off-Ëœ âŠ‘{(8â€¢bit._xorË 6â†‘Ë˜ğ•©)âˆ¾6â†“âŠğ•©}âŒ¾(64â€¿8â€¢bit._castâŠ¢)â‰Ë˜ğ•¨â€¿ğ•©+off}  # thank you dzaima
DownShift â† âŒŠâˆ˜(âŠ¢Ã·(2â‹†âŠ£))

Step â† {ğ•ŠâŸ¨aâ€¿bâ€¿c,xs,iâŸ©:
  Comboâ† {4:a;5:b;6:c;7:!0;ğ•©}
  my â† âŸ¨âŸ©
  nexti â† i+2
  {
    0ğ•Šx: a â†© (Combo x) DownShift a;
    6ğ•Šx: b â†© (Combo x) DownShift a;
    7ğ•Šx: c â†© (Combo x) DownShift a;
    1ğ•Šx: b â†© x Xor b;
    2ğ•Šx: b â†© 8|Combo x;
    3ğ•Šx: {a=0?@;nextiâ†©x};
    4ğ•Šx: b â†© b Xor c;
    5ğ•Šx: my â†© â‹ˆ8|Combo x
  }` xsâŠ‘Ëœ âŸ¨iâŸ©â€¿âŸ¨i+1âŸ©
  nexti
  âŸ¨aâ€¿bâ€¿c,xs,nextiâŸ©â€¿my
}
IsDone â† 2âŠ¸âŠ‘â‰¥â‰ âˆ˜(1âŠ¸âŠ‘)

Run â† {regğ•Šprog:
  ys â† âŸ¨âŸ©
  state â† {
    stateâ€¿my â† Step ğ•©
    ys âˆ¾â†© my
    state
  } â€¢_while_ (Â¬âˆ˜IsDone) regâ€¿progâ€¿0
  stateâ€¿ys
}

! 1â‰¡1âŠ‘âŠ‘âŠ‘ 0â€¿0â€¿9 Run 2â€¿6
! 0â€¿1â€¿2â‰¡1âŠ‘ 10â€¿0â€¿0 Run 5â€¿0â€¿5â€¿1â€¿5â€¿4
! 4â€¿2â€¿5â€¿6â€¿7â€¿7â€¿7â€¿7â€¿3â€¿1â€¿0â‰¡1âŠ‘ 2024â€¿0â€¿0 Run 0â€¿1â€¿5â€¿4â€¿3â€¿0
! 0â‰¡0âŠ‘âŠ‘âŠ‘ 2024â€¿0â€¿0 Run 0â€¿1â€¿5â€¿4â€¿3â€¿0
! 26â‰¡1âŠ‘âŠ‘âŠ‘ 0â€¿29â€¿0 Run 1â€¿7
! 44354â‰¡1âŠ‘âŠ‘âŠ‘ 0â€¿2024â€¿43690 Run 4â€¿0

â€¢Show 1âŠ‘ reg Run prog

NatFromDigits â† {0âŠ¸(ğ•¨âŠ¸Ã—âŠ¸+ËœÂ´) ğ•©}

# based on my input:
# B and C registers are only for temps, A gets shifted down by one octal digit at a time. build up A one octal digit at a time, from most significant (last output) to least significant (first output)
TheProgram â† { 1âŠ‘ ğ•©â€¿0â€¿0 Run prog }
Search â† {
  dsğ•ŠâŸ¨âŸ©: ds;
  dsğ•Šxs:
  candidates â† (8Ã—âŠ‘â‰¢ds)â€¿âˆ˜ â¥Š {ğ•Ši:{iâˆ¾ğ•©}Ë˜ ds}Ë˜ â†•8
  matches â† {ğ•©â‰¡(-â‰ ğ•©)â†‘prog}Â¨ TheProgramÂ¨ 8âŠ¸NatFromDigitsÂ¨ <Ë˜ candidates
  (1â†“xs) SearchËœ matches/candidates
}
ds â† (â‰Ë˜â†•8) Search 1â†“âŒ½prog
ns â† 8âŠ¸NatFromDigitsË˜ ds
â€¢Show âŒŠÂ´ns

