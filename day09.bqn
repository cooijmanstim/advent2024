sizes â† -âŸœ'0' âŠ‘â€¢FLines âŠ‘â€¢args

xs â† â†•âˆ˜â‰ âŠ¸(/Ëœ) âŠ‘<Ë˜ â‰â†‘â€¿2â¥Šsizes
Â·â€¿Â·â€¿yss â† {ğ•Šiâ€¿xsâ€¿yss:
  nâ†iâŠ‘sizes
  { 0=2|i? âŸ¨i+1,   nâ†“xs,yssâˆ¾<    nâ†‘xsâŸ© # file
    ;      âŸ¨i+1,(-n)â†“xs,yssâˆ¾<âŒ½(-n)â†‘xsâŸ© # space
  }
} â€¢_while_ {ğ•Šiâ€¿xsâ€¿yss: 0â‰ â‰ xs} 0â€¿xsâ€¿âŸ¨âŸ©
â€¢Show +Â´ â†•âˆ˜â‰ âŠ¸Ã— âˆ¾ yss

names â† (â‰ sizes)â¥Š â‰ Â¯1Â¨âŠ¸(â‰Ëœ)  â†•âŒˆ2Ã·Ëœâ‰ sizes
poses â† +` Â»sizes
filesâ€¿spaces â† >Â¨ (Â¯1=names)âŠ¸âŠ”âˆ˜(<Ë˜) â‰ [names,sizes,poses]

â€¢Show +Â´ {ğ•Šnameâ€¿nâ€¿x:
  contribution â† nameÃ—+Â´x+â†•n  # contribution if no move
  { ğ•Š[]: contribution;  # no room
    ğ•Šğ•©: iâ†âŠ‘ğ•©
    Â·â€¿spnâ€¿spxâ†iâŠspaces
    { spxâ‰¥x? contribution;  # no room before
      spaces (spn=n)â—¶âŸ¨
        [Â¯1,spn-n,spx+n]âŒ¾(iâŠ¸âŠ),  # adjust space
        iâŠ¸â†‘ âˆ¾ (i+1)âŠ¸â†“,           # remove 0 width space
      âŸ©â†©
      nameÃ—+Â´spx+â†•n  # contribution after move
    }
  } /nâ‰¤1âŠâ‰spaces
}Â¨ <Ë˜âŒ½files

