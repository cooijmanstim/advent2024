sizes â† -âŸœ'0' âŠ‘â€¢FLines âŠ‘â€¢args

xs â† â†•âˆ˜â‰ âŠ¸(/Ëœ) âŠ‘<Ë˜ â‰â†‘â€¿2â¥Šsizes
Â·â€¿Â·â€¿yss â† {ğ•Šiâ€¿xsâ€¿yss:
  nâ†iâŠ‘sizes
  { 0=2|i? âŸ¨i+1,   nâ†“xs,yssâˆ¾<    nâ†‘xsâŸ© # file
    ;      âŸ¨i+1,(-n)â†“xs,yssâˆ¾<âŒ½(-n)â†‘xsâŸ© # space
  }
} â€¢_while_ {ğ•Šiâ€¿xsâ€¿yss: 0â‰ â‰ xs} 0â€¿xsâ€¿âŸ¨âŸ©
â€¢Show +Â´ â†•âˆ˜â‰ âŠ¸Ã— âˆ¾ yss

names â† (â‰ sizes)â¥Š â‰ Â¯1Â¨âŠ¸(â‰Ëœ)  â†•âŒˆ2Ã·Ëœâ‰ sizes
poses â† +` Â»sizes
filesâ€¿spaces â† >Â¨ (Â¯1=names)âŠ¸âŠ”âˆ˜(<Ë˜) â‰ [names,sizes,poses]

â€¢Show +Â´ {ğ•Šnameâ€¿sizeâ€¿pos:
  contribution â† nameÃ—+Â´pos+â†•size  # contribution if no move
  {ğ•Š[]: contribution;
   ğ•Šğ•©: iâ†âŠ‘ğ•©
    Â·â€¿spacesizeâ€¿spaceposâ†iâŠspaces
    { spaceposâ‰¥pos? contribution;
      spaces ([Â¯1,spacesize-size,spacepos+size]âŒ¾(iâŠ¸âŠ))â†©
      nameÃ—+Â´spacepos+â†•size  # contribution after move
    }
  } /sizeâ‰¤1âŠâ‰spaces
}Â¨ <Ë˜âŒ½files

