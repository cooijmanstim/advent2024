ParseNat â† 10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½ -âŸœ'0'
IsDigit â† '0'âŠ¸â‰¤âˆ§â‰¤âŸœ'9'
ClassifyRuns â† Â¯1âŠ¸+ âŠ¢ Ã— +`âˆ˜(0âŠ¸âŒˆ)âˆ˜(-âŸœÂ»)
_fx_ â† {F _ğ•£_ G ğ•©: âŠ‘{pâ€¿n: nâ‹ˆF n} â€¢_while_ (GÂ´) ğ•©â‹ˆFğ•© }

blocks â† ParseNatÂ¨Â¨ ClassifyRunsâˆ˜IsDigitâŠ¸âŠ”Â¨ â€¢FLinesâŠ‘â€¢args
size â† {"ex":7;"in":71}Â¯2â†‘âŠ‘â€¢args
n0 â† {"ex":12;"in":1024}Â¯2â†‘âŠ‘â€¢args

Expand â† { ğ•¨ âˆ§ âˆ¨Â´ âŸ¨âŠ¢,Â«,Â»,Â«Ë˜,Â»Ë˜âŸ© {ğ•ğ•©}Â¨ <ğ•© }
PathLength â† {ğ•Šmap:  # assumes existence
  âŠ‘ { ğ•Štâ€¿p: (t+1) â‹ˆ (Â¬map) Expand p
  } â€¢_while_ {ğ•Štâ€¿p: Â¬Â¯1â€¿Â¯1âŠ‘p} 0â‹ˆ 1âŒ¾(0â€¿0âŠ¸âŠ‘) 0Â¨map
}
PathExistence â† {ğ•Šmap:
  Â¯1â€¿Â¯1 âŠ‘ (Â¬map)âŠ¸Expand _fx_ (â‰¢) 1âŒ¾(0â€¿0âŠ¸âŠ‘) 0Â¨map
}
_binsearch â† {F _ğ•£ aâ€¿b:
  âŠ‘ {ğ•Šaâ€¿b:
    n â† âŒŠa+2Ã·Ëœb-a
    âŸ¨aâ€¿n,nâ€¿bâŸ© âŠ‘Ëœ F n
  } _fx_ (â‰¢) aâ€¿b
}

map â† sizeâ€¿sizeâ¥Š0
â€¢Show PathLength 1Â¨âŒ¾((n0â†‘blocks)âŠ¸âŠ‘) map
n â† { PathExistence 1Â¨âŒ¾((ğ•©â†‘blocks)âŠ¸âŠ‘) map } _binsearch âŸ¨0,â‰ blocksâŸ©
â€¢Show blocksâŠ‘Ëœn

