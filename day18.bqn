ParseNat â† 10âŠ¸Ã—âŠ¸+ËœÂ´âˆ˜âŒ½ -âŸœ'0'
IsDigit â† '0'âŠ¸â‰¤âˆ§â‰¤âŸœ'9'
ClassifyRuns â† Â¯1âŠ¸+ âŠ¢ Ã— +`âˆ˜(0âŠ¸âŒˆ)âˆ˜(-âŸœÂ»)
_fx_ â† {F _ğ•£_ G ğ•©: âŠ‘{pâ€¿n: nâ‹ˆF n} â€¢_while_ (GÂ´) ğ•©â‹ˆFğ•© }

blocks â† ParseNatÂ¨Â¨ ClassifyRunsâˆ˜IsDigitâŠ¸âŠ”Â¨ â€¢FLinesâŠ‘â€¢args
size â† {"ex":7;"in":71}Â¯2â†‘âŠ‘â€¢args
n0 â† {"ex":12;"in":1024}Â¯2â†‘âŠ‘â€¢args

FindPath â† {ğ•Šmap:
  v â† {ğ•Šv:  # flow min costs backward
    (mapâŠ0â€¿âˆ) âŒˆ v âŒŠ 1+ âŒŠÂ´ {ğ•v}Â¨ âŸ¨(sizeâ¥Šâˆ)âŠ¸Â«,(sizeâ¥Šâˆ)âŠ¸Â»,âˆâŠ¸Â«Ë˜,âˆâŠ¸Â»Ë˜âŸ©
  } _fx_ (â‰¢) 0âŒ¾(Â¯1â€¿Â¯1âŠ¸âŠ‘) âˆÂ¨map
  p â† {ğ•Šp:  # flow best-path membership forward
    p âˆ¨Â´ âŸ¨Â»,Â«,Â»Ë˜,Â«Ë˜âŸ© {ğ• p âˆ§ v=1+ğ•v}Â¨ âŸ¨(sizeâ¥Šâˆ)âŠ¸Â«,(sizeâ¥Šâˆ)âŠ¸Â»,âˆâŠ¸Â«Ë˜,âˆâŠ¸Â»Ë˜âŸ©
  } _fx_ (â‰¢) 1âŒ¾(0â€¿0âŠ¸âŠ‘) 0Â¨map
  vâ€¿p
}
_binsearch â† {F _ğ•£ aâ€¿b:
  âŠ‘ {ğ•Šaâ€¿b:
    n â† âŒŠa+2Ã·Ëœb-a
    âŸ¨aâ€¿n,nâ€¿bâŸ© âŠ‘Ëœ F n
  } _fx_ (â‰¢) aâ€¿b
}

map â† sizeâ€¿sizeâ¥Š0
{
  vâ€¿p â† FindPath 1Â¨âŒ¾((n0â†‘blocks)âŠ¸âŠ‘) map
  â€¢Show 0â€¿0âŠ‘v
}
{
  i â† { âˆ>0â€¿0âŠ‘âŠ‘FindPath 1Â¨âŒ¾((ğ•©â†‘blocks)âŠ¸âŠ‘) map } _binsearch âŸ¨0,â‰ blocksâŸ©
  â€¢Show blocksâŠ‘Ëœi
}

