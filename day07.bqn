ParseNat â† 10âŠ¸Ã—âŠ¸+ËœÂ´ âˆ˜âŒ½ -âŸœ'0'
IsDigit â† '0'âŠ¸â‰¤âˆ§â‰¤âŸœ'9'
IdentifyRegions â† {Â¯1+ğ•©Ã—+`0âŒˆğ•©-Â»ğ•©}
_CollectRuns â† {IdentifyRegionsâˆ˜ğ”½âŠ¸âŠ”}
CollectNumbers â† {ğ•Šs: ParseNatÂ¨ IsDigit _CollectRuns s}

equations â† CollectNumbersÂ¨ â€¢FLinesâŠ‘â€¢args

Cat â† {ğ•©+ğ•¨Ã—10â‹†1+âŒŠ10â‹†â¼ğ•©}
â€¢ShowÂ¨ {ğ•Šops:
  +Â´ {
    yâ†âŠ‘ğ•© â‹„ xsâ†1â†“ğ•©
    Foo â† {zğ•Šxs:{
      y<z ? 0;  # abandon branch if already exceeding y
      0=â‰ xs ? z=y;
      âˆ¨Â´ {(zğ•âŠ‘xs) Foo 1â†“xs}Â¨ ops  # could short-circuit this
    }}
    yÃ— (âŠ‘Foo 1âŠ¸â†“) xs
  }Â¨ equations
}Â¨ âŸ¨Ã—â€¿+,Catâ€¿Ã—â€¿+âŸ©

