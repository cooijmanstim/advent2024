_fx_ â† {F _ğ•£_ G ğ•©: âŠ‘{pâ€¿n: nâ‹ˆF n} â€¢_while_ (GÂ´) ğ•©â‹ˆFğ•© }

map â† >â€¢FLinesâŠ‘â€¢args
shifts â† > âŸ¨âŸ¨Â»Ë˜,Â«Ë˜âŸ©,âŸ¨Â»,Â«âŸ©,âŸ¨Â«Ë˜,Â»Ë˜âŸ©,âŸ¨Â«,Â»âŸ©âŸ© # east south west north

infwall â† 0â€¿âˆâŠËœmap='#'
v â† {ğ•Šv:  # flow min costs backward
  forward_v â† shifts {pushâ€¿pullğ•Švi:
    1 + Pull vi
  }Ë˜ v
  rotate_v â† 1000 + (Â¯1âŠ¸âŒ½âŒŠ1âŠ¸âŒ½) v
  goal_v â† âˆâ€¿0âŠËœmap='E'
  infwallâŠ¸âŒˆË˜ goal_vâŠ¸âŒŠË˜ forward_vâŒŠrotate_v
} _fx_ â‰¢ âˆâ¥ŠËœ4âˆ¾â‰¢map  # value map for each heading
â€¢Show âŠ‘ (map='S') /â—‹â¥Š 0âŠv

p â† {ğ•Šp:  # flow best-path membership forward
  forward_p â† shifts {pushâ€¿pullğ•Špiâ€¿vi:
    Push pi âˆ§ vi=1+Pull vi
  }Ë˜ pâ‹ˆË˜v
  rotate_p â† âˆ¨Â´ {(-ğ•©)âŒ½p âˆ§ v=1000+ğ•©âŒ½v}Â¨ Â¯1â€¿1
  p âˆ¨ forward_p âˆ¨ rotate_p
} _fx_ â‰¢ (map='S')âŒ¾âŠ 0Â¨v
â€¢Show +Â´â¥Šâˆ¨Â´<Ë˜p

